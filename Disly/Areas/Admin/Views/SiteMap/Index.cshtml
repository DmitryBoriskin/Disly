@model SiteMapViewModel

@if (Model.UserResolution.Read)
{
    <div class="content">
        <h1>@ViewBag.Title</h1>
        <ol class="breadcrumb">
            <li><a href="/admin/sitemap/">Главная</a></li>
        </ol>

        <div class="row">
            <div class="col-sm-5">
                <h3 class="nesting_title">Список вложенностей</h3>
            </div>
            <div class="col-sm-7">
                <div class="bubble_but">
                    @if (Model.UserResolution.Write)
                    {
                        <a class="button icon-create green" href="/admin/sitemap/item/@Guid.NewGuid()/">Добавить</a>
                    }
                    @if (Model.List.Data != null && Model.List.Data.Count() > 1)
                    {
                        <a class="button icon-sort" value="no-preloader-btn" id="sorting_element" title="Добавляет возможность сортировки элементов списка">Сортировать</a>
                    }
                </div>
            </div>
        </div>

        @if (Model.List != null)
        {
            <div class="site_map_list">
                <table id="sm_list" class="table table-striped">
                    <thead>
                        <tr>
                            <th class="map_site_icon">&nbsp;</th>
                            <th class="map_site_title">Название</th>
                            <th class="map_site_attach">Вложения</th>
                        </tr>
                    </thead>
                    <tbody data-service="/Admin/Services/ChangePermit?group=SiteMap">
                        @foreach (var item in Model.List.Data)
                        {
                            <tr class="ui-sortable-handle" data-id="@item.Id">
                                @if (item.Alias != " ")
                                {
                                    string disabled = item.Disabled ? "disabled" : String.Empty;

                                    string _class = String.Empty;
                                    if (!String.IsNullOrEmpty(item.Url))
                                    {
                                        _class = "icon-site-link";
                                    }
                                    else if (item.CountSibling == 0)
                                    {
                                        _class = "icon-site-page";
                                    }
                                    else
                                    {
                                        _class = "icon-site-folder";
                                    }

                                    <td class="map_site_icon disabled"></td>
                                    <td class="@_class @disabled"><a href="/admin/sitemap/item/@item.Id">@item.Title</a></td>
                                    <td class="sort-element @disabled">@item.CountSibling</td>
                                }
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
    </div>

    <div class="dop_info-block">
        <div class="dop-caption">Фильтр</div>
        @{ Html.RenderAction("Filtr", "Templates", new { @Title = "Группы меню", @Alias = "group", @Icon = "icon-th-list-3", @Url = "/admin/services/MenuGroup/", @BtnName = "Новая группа меню", @Items = Model.MenuTypes }); }
        @*@if (Model.MenuTypes != null)
        {
            <select class="selectpicker" title="Группа меню">
                @foreach (var item in Model.MenuTypes)
                {
                    <option value="@item.value">@item.text</option>
                }
            </select>
        }*@
    </div>
    <div class="buttons"></div>
}
else
{
    <div class="content">
        <p>У вас недостаточно прав.</p>
    </div>
}

