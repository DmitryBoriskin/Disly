@model UsersViewModel

@Html.Partial("Partial/Confirm")
@Html.Partial("Partial/Frame")
@using (Html.BeginForm())
{
    <div id="Buttons">
        @if (ViewBag.ActionName == "create")
        {
            if (Model.UserResolution.Change)
            {
                <button type="submit" name="action" value="create-btn" class="BtnCreate">Сохранить</button>
            }
            <button type="submit" name="action" value="cancel-btn" class="BtnCancel">Закрыть</button>
        }
        else
        {
            if (Model.UserResolution.Change)
            {
                <button type="submit" name="action" value="update-btn" class="BtnSave">Сохранить</button>
            }
            <button type="submit" name="action" value="cancel-btn" class="BtnCancel">Закрыть</button>
            if (Model.UserResolution.Delete)
            {
                <button type="submit" name="action" value="delete-btn" class="BtnDelete">Удалить</button>
            }
        }
    </div>

    if (Model.UserResolution.Read)
    {
        <div id="Content">
            <div id="TitleBlock">@ViewBag.Title</div>
            @Html.ValidationSummary(false, "", new { @class = "alert alert-danger" })
            @Html.TextBoxFor(m => m.User.C_Surname, new { @class = "uc_input", maxlength = "64", @title = "Фамилия" })
            @Html.TextBoxFor(m => m.User.C_Name, new { @class = "uc_input", maxlength = "64", @title = "Имя" })
            @Html.TextBoxFor(m => m.User.C_Patronymic, new { @class = "uc_input", maxlength = "64", @title = "Отчество" })
            <div class="row">
                <div class="col-xs-6">
                    @Html.DropDownListFor(m => m.User.B_Sex, new SelectList(Model.Sex, "Value", "Label", null), new { @class = "uc_input", @title = "Укажите пол" })
                </div>
                <div class="col-xs-6">
                    @if (Model.User.D_Birthday != null)
                    {
                        @Html.TextBoxFor(m => m.User.D_Birthday, new { @class = "uc_input", type = "date", @title = "Дата рождения", @Value = Model.User.D_Birthday.Value.ToString("yyyy-MM-dd") })
                    }
                    else
                    {
                        @Html.TextBoxFor(m => m.User.D_Birthday, new { @class = "uc_input", type = "date", @title = "Дата рождения" })
                    }
                </div>
            </div>
            @Html.TextBoxFor(m => m.User.C_Post, new { @class = "uc_input", type = "text", maxlength = "128", @title = "Должность" })

            <div class="GroupBlock Rules" title="Контакты">
                @Html.TextBoxFor(m => m.User.C_Adres, new { @class = "uc_input", @title = "Адрес" })
                @Html.TextBoxFor(m => m.User.C_Phone, new { @class = "uc_input", maxlength = "64", @title = "Телефон" })
                @Html.TextBoxFor(m => m.User.C_Mobile, new { @class = "uc_input", maxlength = "64", @title = "Телефон (моб.)" })
                @Html.TextBoxFor(m => m.User.C_Contacts, new { @class = "uc_input", @title = "Дополнительные контакты" })
            </div>
        </div>

        <div id="DopInfo">
            <div class="GroupBlock Rules Open" title="Права авторизации">
                @Html.TextBoxFor(m => m.User.C_EMail, new { @class = "uc_input", type = "email", maxlength = "128", autocomplete = "off", @title = "Email адрес" })
                @Html.DropDownListFor(m => m.User.F_Group, new SelectList(Model.Group, "C_Alias", "C_GroupName", 0), new { @class = "uc_input", @title = "Группа" })
                @if (ViewBag.ActionName == "create")
                {
                    @Html.TextBoxFor(m => m.pass, new { @class = "uc_input", type = "password", minlength = "6", maxlength = "64", autocomplete = "off", @title = "Пароль" })
                    @Html.TextBoxFor(m => m.pass, new { @class = "uc_input", type = "password", minlength = "6", maxlength = "64", autocomplete = "off", @title = "Подтверждение пароля" })
                }
                @Html.CheckBoxFor(m => m.User.B_Disabled, new { @class = "uc_input", @type = "checkbox", @title = "Запретить доступ" })
            </div>

            @if (ViewBag.ActionName != "create")
            {
                <a id="Resolutions" class="Button PopUpFrame icon-key-1" title="Права пользователя" data-class="Resolutions" href="/admin/services/UserResolutions/@Model.User.Id">Настройки доступа</a>
                <a id="ChengePass" class="Button PopUpFrame icon-key-1" data-class="ChengePass" title="Изменение пароля" href="/admin/users/ChangePass/@Model.User.Id">Изменить пароль</a>
                <a id="LogLists" class="Button PopUpFrame icon-archive" data-class="LogList" title="Журнал изменений" href="/admin/services/log/@Model.User.Id">Журнал изменений</a>                
            }

        </div>
    }

    if (ViewBag.Message != null)
    {
        @Html.Partial("Partial/modal")
    }
}
