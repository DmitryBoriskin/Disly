@model UsersViewModel

@Html.Partial("Partial/Confirm")
@Html.Partial("Partial/Frame")
@using (Html.BeginForm()) 
{
    @Html.AntiForgeryToken()
    <div id="Buttons">
        @if (Model.UserResolution.Write)
        {
            @Html.ActionLink("Создать", "Create", "AllUsers", new { @id= @Guid.NewGuid() }, new { @class="Button BtnCreate" })
        }        
    </div>

    if (Model.UserResolution.Read)
    {
        <div id="Content">
            <div id="TitleBlock">@ViewBag.Title</div>
            @if (Model.getUsersList != null)
            {
                foreach (UsersModel user in Model.getUsersList)
                {
                    <div class="ListItem User">
                        @Html.ActionLink(@user.C_Surname + " " + @user.C_Name, "Edit", "AllUsers", new { id = @user.Id }, new { @title = "Перейти к редактированию" })
                        <div>Группа: <span>@user.F_GroupName</span></div>
                        <div>E-mail: <span>@user.C_EMail</span></div>
                    </div>
                }
            }
            else
            {
                <p>Нет пользователей.</p>
            }
        </div>

        <div id="DopInfo">
            <div class="DopCaption">Фильтр</div>
            @Html.TextBoxFor(m => Model.searchSurname, new { @class = "uc_input", @placeholder = "Фамилия", @MaxLength = "128", @data_help = "Поиск по фамилии пользователя." })
            @Html.TextBoxFor(m => Model.searchName, new { @class = "uc_input", @placeholder = "Имя", @MaxLength = "128", @data_help = "Поиск по имени пользователя." })
            @Html.TextBoxFor(m => Model.searchEmail, new { @class = "uc_input", @placeholder = "Email", @MaxLength = "128", @data_help = "Поиск адресу электронной почты пользователя." })
            <button type="submit" class="btn btn-primary">Найти</button>


            <div class="DopCaption icon-users-3 FiltGroup">Группы</div>
            <div class="TreeRoot">
                <div class="TreeLink Now">
                    <span class="treeIcon"></span>
                    @Html.ActionLink("Все", "index", "AllUsers", new { @class = "treeUrl" })
                </div>
            </div>
            <div class="TreeBranch">
                @foreach (UsersGroupModel group in Model.Group)
                {
                    <div class="TreeItem">
                        <div class="TreeLink">
                            @Html.ActionLink(" ", "UsersGroup", "Services", new { @alias = @group.C_Alias }, new { @class = "treeBtn PopUpFrame Edit", @data_class = "UserGroup", @title = "Редактирование группы пользователей" })
                            <span class="treeIcon"></span>
                            @Html.ActionLink(group.C_GroupName, "index", "AllUsers", new { @group = @group.C_Alias }, new { @class = "treeUrl" })
                        </div>
                    </div>
                }
            </div>
            @Html.ActionLink("Добавить группу", "UsersGroup", "Services", null, new { @id = "NewUserGroup", @class = "Button PopUpFrame icon-user-add", @title = "Новая группа пользователей", @data_class = "UserGroup" })


        </div>
    }
    else {<div id="Content"><p>У вас недостаточно прав.</p></div> }


}


